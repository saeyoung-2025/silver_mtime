import React, { useState, useEffect } from 'react';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar } from 'recharts';
import { TrendingUp, DollarSign, Package, Activity, Moon, Sun, Settings, Newspaper, Factory, ChevronDown, ChevronUp, RefreshCw, ExternalLink, BarChart3, BookOpen, Briefcase, TrendingUp as TrendUp } from 'lucide-react';

function App() {
  const [darkMode, setDarkMode] = useState(true);
  const [showStocksGuide, setShowStocksGuide] = useState(false);
  const [showPortfolio, setShowPortfolio] = useState(false);
  const [showInvestGuide, setShowInvestGuide] = useState(false);
  const [showSettings, setShowSettings] = useState(false);
  const [showToast, setShowToast] = useState(false);
  const [toastMessage, setToastMessage] = useState('');
  const [showAppGuide, setShowAppGuide] = useState(false);
  const [showHistory, setShowHistory] = useState(false);
  
  const [copperChartPeriod, setCopperChartPeriod] = useState('1y');
  const [silverChartPeriod, setSilverChartPeriod] = useState('1y');
  const [goldChartPeriod, setGoldChartPeriod] = useState('1y');
  const [copperChartExpanded, setCopperChartExpanded] = useState(false);
  const [silverChartExpanded, setSilverChartExpanded] = useState(false);
  const [goldChartExpanded, setGoldChartExpanded] = useState(false);
  
  const [tempSettings, setTempSettings] = useState({ 
    rsiBuy: 35, 
    rsiSell: 65,
    dollarIndex: 100,
    inventory: 145000,
    pmi: 50,
    macd: 0
  });
  const [tempIndicatorSettings, setTempIndicatorSettings] = useState({
    dollarIndex: { enabled: true }, inventory: { enabled: true }, pmi: { enabled: true }, rsi: { enabled: true }, macd: { enabled: true }
  });
  
  const [currentData, setCurrentData] = useState({
    copperPrice: 0, dollarIndex: 0, inventory: 145000, pmi: 50.2, rsi: 0, macd: 0, signal: 'HOLD',
    prevClose: 0, todayOpen: 0, todayHigh: 0, todayLow: 0, week52High: 0, week52Low: 0, yearChangePercent: 0
  });

  const [indicatorSettings, setIndicatorSettings] = useState({
    dollarIndex: { enabled: true }, inventory: { enabled: true }, pmi: { enabled: true }, rsi: { enabled: true }, macd: { enabled: true }
  });

  const [customSettings, setCustomSettings] = useState({ 
    rsiBuy: 35, 
    rsiSell: 65,
    dollarIndex: 100,
    inventory: 145000,
    pmi: 50,
    macd: 0
  });

  const [fullData, setFullData] = useState([]);
  const [silverData, setSilverData] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [lastUpdated, setLastUpdated] = useState(null);
  const [signalHistory, setSignalHistory] = useState([]);
  
  // í•œêµ­ ê´€ë ¨ì£¼ ë°ì´í„°
  const [krStocks] = useState([
    { type: 'ETF', name: 'KODEX êµ¬ë¦¬ì„ ë¬¼(H)', code: '138910', url: 'https://finance.naver.com/item/main.nhn?code=138910' },
    { type: 'ETN', name: 'ì‚¼ì„± êµ¬ë¦¬ ì„ ë¬¼ ETN(H)', code: '530095', url: 'https://finance.naver.com/item/main.nhn?code=530095' },
    { type: 'ì£¼ì‹', name: 'í’ì‚°', code: '103140', url: 'https://finance.naver.com/item/main.nhn?code=103140' },
    { type: 'ì£¼ì‹', name: 'LS', code: '006260', url: 'https://finance.naver.com/item/main.nhn?code=006260' },
    { type: 'ì£¼ì‹', name: 'ê³ ë ¤ì•„ì—°', code: '010130', url: 'https://finance.naver.com/item/main.nhn?code=010130' }
  ]);

  const correlationData = [
    { name: 'ì€', correlation: 0.82, price: 24.5 },
    { name: 'ì•Œë£¨ë¯¸ëŠ„', correlation: 0.68, price: 2.15 },
    { name: 'ì•„ì—°', correlation: 0.75, price: 2.50 }
  ];

  const indicatorNames = { dollarIndex: 'ë‹¬ëŸ¬', inventory: 'ì¬ê³ ëŸ‰', pmi: 'PMI', rsi: 'RSI', macd: 'MACD' };
  
  const getIndicatorCondition = (key) => {
    switch(key) {
      case 'dollarIndex': return `< ${customSettings.dollarIndex || 100}`;
      case 'inventory': return `< ${(customSettings.inventory || 145000).toLocaleString()}`;
      case 'pmi': return `> ${customSettings.pmi || 50}`;
      case 'rsi': return `< ${customSettings.rsiBuy || 35}`;
      case 'macd': return `> ${customSettings.macd || 0}`;
      default: return '';
    }
  };

  const getFilteredData = (period, data = fullData) => {
    if (data.length === 0) return [];
    let days;
    switch(period) {
      case '1w': days = 7; break;
      case '1m': days = 30; break;
      case '6m': days = 180; break;
      case '1y': days = 365; break;
      case '10y': days = 3650; break;
      default: days = 365;
    }
    return data.slice(-days);
  };

  const calculateScore = () => {
    let total = 0, max = 0;
    const results = {};
    if (indicatorSettings.dollarIndex.enabled) { max += 20; if (currentData.dollarIndex < customSettings.dollarIndex) { total += 20; results.dollarIndex = true; } else results.dollarIndex = false; }
    if (indicatorSettings.inventory.enabled) { max += 20; if (currentData.inventory < customSettings.inventory) { total += 20; results.inventory = true; } else results.inventory = false; }
    if (indicatorSettings.pmi.enabled) { max += 20; if (currentData.pmi > customSettings.pmi) { total += 20; results.pmi = true; } else results.pmi = false; }
    if (indicatorSettings.rsi.enabled) { max += 20; if (currentData.rsi < customSettings.rsiBuy) { total += 20; results.rsi = true; } else results.rsi = false; }
    if (indicatorSettings.macd.enabled) { max += 20; if (currentData.macd > customSettings.macd) { total += 20; results.macd = true; } else results.macd = false; }
    return { score: total, maxScore: max, percentage: max > 0 ? Math.round((total / max) * 100) : 0, results };
  };

  const scoreData = calculateScore();

  // ì‚¬ìš©ì¤‘ì¸ ì§€í‘œ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
  const getActiveIndicators = () => {
    const active = [];
    if (indicatorSettings.dollarIndex.enabled) active.push('ë‹¬ëŸ¬');
    if (indicatorSettings.inventory.enabled) active.push('ì¬ê³ ëŸ‰');
    if (indicatorSettings.pmi.enabled) active.push('PMI');
    if (indicatorSettings.rsi.enabled) active.push('RSI');
    if (indicatorSettings.macd.enabled) active.push('MACD');
    return active.length === 5 ? 'ì „ì²´ 5ê°œ' : active.join(', ');
  };

  // íˆìŠ¤í† ë¦¬ ì €ì¥
  const saveToHistory = (data, score, signal) => {
    const today = new Date().toLocaleDateString('ko-KR', { month: 'numeric', day: 'numeric' });
    const newEntry = {
      date: today,
      signal: signal,
      score: score.score,
      maxScore: score.maxScore,
      price: data.copperPrice,
      indicators: getActiveIndicators()
    };
    
    const saved = localStorage.getItem('copperHistory');
    let history = saved ? JSON.parse(saved) : [];
    
    // ê°™ì€ ë‚ ì§œ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸
    const existingIndex = history.findIndex(h => h.date === today);
    if (existingIndex >= 0) {
      history[existingIndex] = newEntry;
    } else {
      history.unshift(newEntry);
    }
    
    // ìµœê·¼ 5ì¼ë§Œ ìœ ì§€
    history = history.slice(0, 5);
    
    localStorage.setItem('copperHistory', JSON.stringify(history));
    setSignalHistory(history);
  };

  // LocalStorageì—ì„œ ì„¤ì • ë° íˆìŠ¤í† ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
  useEffect(() => {
    const saved = localStorage.getItem('copperAppSettings');
    if (saved) {
      try {
        const parsed = JSON.parse(saved);
        if (parsed.customSettings) {
          // ê¸°ì¡´ ì„¤ì •ê³¼ ìƒˆ ê¸°ë³¸ê°’ ë³‘í•©
          setCustomSettings(prev => ({
            ...prev,
            ...parsed.customSettings
          }));
        }
        if (parsed.indicatorSettings) setIndicatorSettings(prev => ({ ...prev, ...parsed.indicatorSettings }));
      } catch (e) { console.log('ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨'); }
    }
    
    const historyData = localStorage.getItem('copperHistory');
    if (historyData) {
      setSignalHistory(JSON.parse(historyData));
    }
  }, []);

  // ì•± ì‹œì‘ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨
  useEffect(() => {
    refreshData();
  }, []);

  const refreshData = async () => {
    setIsLoading(true);
    try {
      const proxyUrl = 'https://corsproxy.io/?';
      const [copperRes, dollarRes, goldRes, silverRes] = await Promise.all([
        fetch(proxyUrl + encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/HG=F?interval=1d&range=10y')),
        fetch(proxyUrl + encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/DX-Y.NYB?interval=1d&range=10y')),
        fetch(proxyUrl + encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/GC=F?interval=1d&range=10y')),
        fetch(proxyUrl + encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/SI=F?interval=1d&range=10y'))
      ]);
      
      const copperData = await copperRes.json();
      const dollarData = await dollarRes.json();
      const goldData = await goldRes.json();
      const silverDataRes = await silverRes.json();
      
      const copperMeta = copperData?.chart?.result?.[0]?.meta || {};
      const copperPrice = copperMeta.regularMarketPrice || 0;
      const dollarIndex = dollarData?.chart?.result?.[0]?.meta?.regularMarketPrice || 0;
      
      const copperPrices = copperData?.chart?.result?.[0]?.indicators?.quote?.[0]?.close || [];
      const copperOpens = copperData?.chart?.result?.[0]?.indicators?.quote?.[0]?.open || [];
      const copperHighs = copperData?.chart?.result?.[0]?.indicators?.quote?.[0]?.high || [];
      const copperLows = copperData?.chart?.result?.[0]?.indicators?.quote?.[0]?.low || [];
      const validPrices = copperPrices.filter(p => p !== null);
      
      const rsi = calculateRSI(validPrices, 14);
      const macd = calculateMACD(validPrices);
      
      // êµ¬ë¦¬ ìƒì„¸ ë°ì´í„° - ì§ì ‘ ê³„ì‚°
      const prevClose = validPrices.length >= 2 ? validPrices[validPrices.length - 2] : 0;
      const todayOpen = copperOpens.length > 0 ? copperOpens[copperOpens.length - 1] || 0 : 0;
      const todayHigh = copperHighs.length > 0 ? copperHighs[copperHighs.length - 1] || 0 : 0;
      const todayLow = copperLows.length > 0 ? copperLows[copperLows.length - 1] || 0 : 0;
      const week52High = copperMeta.fiftyTwoWeekHigh || Math.max(...validPrices.slice(-252));
      const week52Low = copperMeta.fiftyTwoWeekLow || Math.min(...validPrices.slice(-252).filter(p => p > 0));
      const yearAgoPrice = validPrices[validPrices.length - 252] || validPrices[0] || copperPrice;
      const yearChangePercent = yearAgoPrice > 0 ? ((copperPrice - yearAgoPrice) / yearAgoPrice * 100) : 0;
      
      // ì°¨íŠ¸ ë°ì´í„°
      const timestamps = copperData?.chart?.result?.[0]?.timestamp || [];
      const goldPrices = goldData?.chart?.result?.[0]?.indicators?.quote?.[0]?.close || [];
      const silverPrices = silverDataRes?.chart?.result?.[0]?.indicators?.quote?.[0]?.close || [];
      
      const chartData = timestamps.map((ts, i) => ({
        date: new Date(ts * 1000).toLocaleDateString('ko-KR', { year: 'numeric', month: 'short', day: 'numeric' }),
        copper: copperPrices[i] ? parseFloat(copperPrices[i].toFixed(2)) : null,
        gold: goldPrices[i] ? parseFloat(goldPrices[i].toFixed(0)) : null
      })).filter(d => d.copper !== null);
      
      const silverChartData = timestamps.map((ts, i) => ({
        date: new Date(ts * 1000).toLocaleDateString('ko-KR', { year: 'numeric', month: 'short', day: 'numeric' }),
        silver: silverPrices[i] ? parseFloat(silverPrices[i].toFixed(2)) : null
      })).filter(d => d.silver !== null);
      
      setFullData(chartData);
      setSilverData(silverChartData);
      
      // ì‹ í˜¸ íŒë‹¨
      let buyConditions = 0, totalConditions = 0;
      if (indicatorSettings.rsi.enabled) { totalConditions++; if (rsi < customSettings.rsiBuy) buyConditions++; }
      if (indicatorSettings.dollarIndex.enabled) { totalConditions++; if (dollarIndex < customSettings.dollarIndex) buyConditions++; }
      if (indicatorSettings.macd.enabled) { totalConditions++; if (macd > customSettings.macd) buyConditions++; }
      if (indicatorSettings.pmi.enabled) { totalConditions++; if (currentData.pmi > customSettings.pmi) buyConditions++; }
      if (indicatorSettings.inventory.enabled) { totalConditions++; if (currentData.inventory < customSettings.inventory) buyConditions++; }

      let signal = 'HOLD';
      const ratio = totalConditions > 0 ? buyConditions / totalConditions : 0;
      if (ratio >= 0.6) signal = 'BUY';
      else if (rsi > customSettings.rsiSell && macd < 0) signal = 'SELL';
      
      const newData = {
        copperPrice: parseFloat(copperPrice.toFixed(2)),
        dollarIndex: parseFloat(dollarIndex.toFixed(1)),
        inventory: currentData.inventory,
        pmi: currentData.pmi,
        rsi: parseFloat(rsi.toFixed(1)),
        macd: parseFloat(macd.toFixed(2)),
        signal,
        prevClose: parseFloat(prevClose.toFixed(3)),
        todayOpen: parseFloat(todayOpen.toFixed(3)),
        todayHigh: parseFloat(todayHigh.toFixed(3)),
        todayLow: parseFloat(todayLow.toFixed(3)),
        week52High: parseFloat(week52High.toFixed(2)),
        week52Low: parseFloat(week52Low.toFixed(2)),
        yearChangePercent: parseFloat(yearChangePercent.toFixed(2))
      };
      
      setCurrentData(newData);
      setLastUpdated(new Date().toLocaleTimeString('ko-KR'));
      
      // íˆìŠ¤í† ë¦¬ ì €ì¥
      const newScore = { score: 0, maxScore: 0 };
      let t = 0, m = 0;
      if (indicatorSettings.dollarIndex.enabled) { m += 20; if (dollarIndex < customSettings.dollarIndex) t += 20; }
      if (indicatorSettings.inventory.enabled) { m += 20; if (currentData.inventory < customSettings.inventory) t += 20; }
      if (indicatorSettings.pmi.enabled) { m += 20; if (currentData.pmi > customSettings.pmi) t += 20; }
      if (indicatorSettings.rsi.enabled) { m += 20; if (rsi < customSettings.rsiBuy) t += 20; }
      if (indicatorSettings.macd.enabled) { m += 20; if (macd > customSettings.macd) t += 20; }
      newScore.score = t;
      newScore.maxScore = m;
      
      saveToHistory(newData, newScore, signal);
      setToastMessage('ìµœì‹  ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤');
    } catch (error) {
      console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
      setToastMessage('ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
    setIsLoading(false);
    setShowToast(true);
    setTimeout(() => setShowToast(false), 2000);
  };
  
  const calculateRSI = (prices, period = 14) => {
    if (prices.length < period + 1) return 50;
    const changes = [];
    for (let i = 1; i < prices.length; i++) changes.push(prices[i] - prices[i - 1]);
    const recent = changes.slice(-period);
    let gains = 0, losses = 0;
    recent.forEach(c => { if (c > 0) gains += c; else losses += Math.abs(c); });
    const avgGain = gains / period, avgLoss = losses / period;
    if (avgLoss === 0) return 100;
    return 100 - (100 / (1 + avgGain / avgLoss));
  };
  
  const calculateMACD = (prices) => {
    if (prices.length < 26) return 0;
    return calculateEMA(prices, 12) - calculateEMA(prices, 26);
  };
  
  const calculateEMA = (prices, period) => {
    if (prices.length < period) return prices[prices.length - 1] || 0;
    const k = 2 / (period + 1);
    let ema = prices.slice(0, period).reduce((a, b) => a + b, 0) / period;
    for (let i = period; i < prices.length; i++) ema = prices[i] * k + ema * (1 - k);
    return ema;
  };

  const toggleTempIndicator = (key) => setTempIndicatorSettings(prev => ({ ...prev, [key]: { enabled: !prev[key].enabled } }));

  const saveSettings = () => {
    setCustomSettings({...tempSettings});
    setIndicatorSettings(prev => {
      const newSettings = {...prev};
      Object.keys(tempIndicatorSettings).forEach(key => { newSettings[key] = { ...newSettings[key], enabled: tempIndicatorSettings[key].enabled }; });
      localStorage.setItem('copperAppSettings', JSON.stringify({ customSettings: tempSettings, indicatorSettings: newSettings }));
      return newSettings;
    });
    setToastMessage('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
    setShowToast(true);
    setTimeout(() => setShowToast(false), 2000);
    setShowSettings(false);
  };

  useEffect(() => {
    if (showSettings) {
      setTempSettings({...customSettings});
      setTempIndicatorSettings({ dollarIndex: { enabled: indicatorSettings.dollarIndex.enabled }, inventory: { enabled: indicatorSettings.inventory.enabled }, pmi: { enabled: indicatorSettings.pmi.enabled }, rsi: { enabled: indicatorSettings.rsi.enabled }, macd: { enabled: indicatorSettings.macd.enabled } });
    }
  }, [showSettings]);

  const getTabStyle = (isActive) => ({ padding: '6px 12px', fontSize: '12px', border: 'none', borderRadius: '6px', cursor: 'pointer', backgroundColor: isActive ? '#3b82f6' : (darkMode ? '#334155' : '#e5e7eb'), color: isActive ? 'white' : (darkMode ? '#94a3b8' : '#6b7280'), fontWeight: isActive ? '600' : '400' });
  const getPeriodLabel = (p) => { switch(p) { case '1w': return '1ì£¼ì¼'; case '1m': return '1ê°œì›”'; case '6m': return '6ê°œì›”'; case '1y': return '1ë…„'; case '10y': return '10ë…„'; default: return '1ë…„'; } };
  const getSignalText = (s) => s === 'BUY' ? 'ë§¤ìˆ˜ ì‹ í˜¸' : s === 'SELL' ? 'ë§¤ë„ ì‹ í˜¸' : 'ê´€ë§';
  const getRecommendation = () => { if (scoreData.percentage >= 80) return 'ì ê·¹ ë§¤ìˆ˜ ê¶Œì¥'; if (scoreData.percentage >= 60) return 'ë§¤ìˆ˜ ì í•©'; if (scoreData.percentage >= 40) return 'ë¶„í•  ë§¤ìˆ˜ ê³ ë ¤'; return 'ê´€ë§ ê¶Œì¥'; };

  const styles = {
    app: { minHeight: '100vh', background: darkMode ? 'linear-gradient(to bottom right, #0f172a, #1e293b, #0f172a)' : '#f9fafb', padding: '20px 16px' },
    container: { maxWidth: '600px', margin: '0 auto', width: '100%' },
    header: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px', flexWrap: 'wrap', gap: '12px' },
    title: { fontSize: '28px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827', marginBottom: '4px' },
    subtitle: { color: darkMode ? '#94a3b8' : '#6b7280', fontSize: '14px' },
    buttonGroup: { display: 'flex', gap: '8px' },
    button: { padding: '10px', borderRadius: '8px', border: 'none', cursor: 'pointer', backgroundColor: darkMode ? '#334155' : '#e5e7eb', color: darkMode ? 'white' : '#111827' },
    signalCard: { background: currentData.signal === 'BUY' ? '#22c55e' : currentData.signal === 'SELL' ? '#ef4444' : '#eab308', borderRadius: '16px', padding: '24px', marginBottom: '16px', color: 'white', boxShadow: '0 10px 15px -3px rgba(0,0,0,0.3)' },
    card: { backgroundColor: darkMode ? '#1e293b' : 'white', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, borderRadius: '12px', padding: '16px', marginBottom: '16px' },
    grid: { display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '12px', marginBottom: '16px' },
    metricCard: { backgroundColor: darkMode ? '#1e293b' : 'white', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, borderRadius: '12px', padding: '12px', cursor: 'pointer', textDecoration: 'none', color: 'inherit', display: 'block' },
    metricValue: { fontSize: '20px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827', marginTop: '6px' },
    sectionTitle: { color: darkMode ? 'white' : '#111827', fontWeight: 'bold', fontSize: '16px', margin: 0 },
    newsItem: { backgroundColor: darkMode ? '#0f172a' : '#f9fafb', padding: '12px', borderRadius: '8px', marginBottom: '8px' },
    toggle: { width: '44px', height: '24px', borderRadius: '12px', cursor: 'pointer', position: 'relative' },
    toggleKnob: { width: '20px', height: '20px', borderRadius: '50%', backgroundColor: 'white', position: 'absolute', top: '2px', boxShadow: '0 1px 3px rgba(0,0,0,0.3)' },
    performanceItem: { backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', padding: '12px', borderRadius: '8px', marginBottom: '8px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' },
    table: { width: '100%', borderCollapse: 'collapse', fontSize: '13px' },
    th: { padding: '10px 8px', textAlign: 'left', borderBottom: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, color: darkMode ? '#94a3b8' : '#6b7280', fontWeight: '600' },
    td: { padding: '10px 8px', borderBottom: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, color: darkMode ? '#e2e8f0' : '#374151' }
  };

  return (
    <div style={styles.app}>
      <style>{`@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }`}</style>
      
      <div style={styles.container}>
        {showToast && <div style={{ position: 'fixed', top: '20px', left: '50%', transform: 'translateX(-50%)', backgroundColor: '#22c55e', color: 'white', padding: '12px 24px', borderRadius: '8px', fontSize: '14px', fontWeight: '500', boxShadow: '0 4px 12px rgba(0,0,0,0.3)', zIndex: 1000 }}>âœ“ {toastMessage}</div>}
        
        <div style={styles.header}>
          <div>
            <h1 style={styles.title}>êµ¬ë¦¬ ë§¤ìˆ˜ ì‹œì  ë¶„ì„</h1>
            <p style={styles.subtitle}>{lastUpdated ? `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${lastUpdated}` : 'ë°ì´í„° ë¡œë”© ì¤‘...'}</p>
          </div>
          <div style={styles.buttonGroup}>
            <button onClick={() => setDarkMode(!darkMode)} style={styles.button}>{darkMode ? <Sun size={18} /> : <Moon size={18} />}</button>
            <button onClick={refreshData} style={{...styles.button, opacity: isLoading ? 0.6 : 1}} disabled={isLoading}><RefreshCw size={18} style={{animation: isLoading ? 'spin 1s linear infinite' : 'none'}} /></button>
            <button onClick={() => setShowSettings(!showSettings)} style={styles.button}><Settings size={18} /></button>
          </div>
        </div>

        <div style={styles.signalCard}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: '12px' }}>
            <div><h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '4px' }}>{getSignalText(currentData.signal)}</h2><p style={{opacity: 0.8, margin: 0, fontSize: '13px'}}>ì¢…í•© ë¶„ì„ ê²°ê³¼ (ì„¤ì • ì§€í‘œ ê¸°ì¤€)</p></div>
            <a href="https://finance.yahoo.com/quote/HG=F/" target="_blank" rel="noopener noreferrer" style={{textAlign: 'right', textDecoration: 'none', color: 'white'}}>
              <div style={{ fontSize: '40px', fontWeight: 'bold' }}>${currentData.copperPrice}</div>
              <div style={{opacity: 0.8, fontSize: '13px'}}>í˜„ì¬ êµ¬ë¦¬ ê°€ê²© (Yahoo Finance) â†—</div>
            </a>
          </div>
        </div>

        {/* êµ¬ë¦¬ ê¸ˆì¼ í˜„í™© */}
        <div style={styles.card}>
          <h3 style={{...styles.sectionTitle, marginBottom: '4px'}}>ğŸ“ˆ êµ¬ë¦¬ ê¸ˆì¼ í˜„í™©</h3>
          <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '0 0 12px 0'}}>â€» Yahoo Finance ê¸°ì¤€, ì‹¤ì œì™€ ì°¨ì´ ìˆì„ ìˆ˜ ìˆìŒ</p>
          <div style={{display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '10px'}}>
            <div style={{padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px'}}>
              <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ì „ì¼ ì¢…ê°€</div>
              <div style={{fontSize: '16px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827'}}>${currentData.prevClose}</div>
            </div>
            <div style={{padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px'}}>
              <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ê¸ˆì¼ ì‹œê°€</div>
              <div style={{fontSize: '16px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827'}}>${currentData.todayOpen}</div>
            </div>
            <div style={{padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px'}}>
              <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ê¸ˆì¼ ë³€ë™</div>
              <div style={{fontSize: '16px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827'}}>${currentData.todayLow}~{currentData.todayHigh}</div>
            </div>
            <div style={{padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px'}}>
              <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>52ì£¼ ë²”ìœ„</div>
              <div style={{fontSize: '16px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827'}}>${currentData.week52Low}~{currentData.week52High}</div>
            </div>
            <div style={{padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px', gridColumn: 'span 2'}}>
              <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>1ë…„ ë³€ë™ë¥ </div>
              <div style={{fontSize: '18px', fontWeight: 'bold', color: currentData.yearChangePercent >= 0 ? '#22c55e' : '#ef4444'}}>{currentData.yearChangePercent >= 0 ? '+' : ''}{currentData.yearChangePercent}%</div>
            </div>
          </div>
        </div>

        {/* ìƒì„¸ ë¶„ì„ */}
        <div style={{...styles.card, background: darkMode ? 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%)' : 'linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)', borderColor: darkMode ? '#3b82f6' : '#93c5fd'}}>
          <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '8px'}}>
              <span style={{fontSize: '24px'}}>ğŸ“Š</span>
              <div><div style={{fontSize: '18px', fontWeight: 'bold', color: darkMode ? '#93c5fd' : '#1e40af'}}>ì ìˆ˜: {scoreData.score}ì  / {scoreData.maxScore}ì </div><div style={{fontSize: '12px', color: darkMode ? '#bfdbfe' : '#3b82f6'}}>{getRecommendation()}</div></div>
            </div>
            <div style={{fontSize: '24px', fontWeight: 'bold', color: darkMode ? '#93c5fd' : '#1e40af'}}>{scoreData.percentage}%</div>
          </div>
          <div style={{fontSize: '13px', color: darkMode ? '#e0e7ff' : '#1e40af', lineHeight: '1.6', marginBottom: '12px'}}>{scoreData.percentage >= 60 ? 'í™œì„±í™”ëœ ì§€í‘œë“¤ì´ ë§¤ìˆ˜ ì¡°ê±´ì„ ì¶©ì¡±í•˜ê³  ìˆìŠµë‹ˆë‹¤.' : 'ì¶”ì„¸ëŠ” ìœ ì§€ë˜ì§€ë§Œ ëª¨ë©˜í…€ì´ ë‘”í™”ë˜ì–´ í˜„ì¬ëŠ” ê´€ë§ì´ ìœ ë¦¬í•©ë‹ˆë‹¤.'}</div>
          <div style={{display: 'flex', flexWrap: 'wrap', gap: '6px'}}>
            {Object.entries(indicatorSettings).map(([key, setting]) => {
              if (!setting.enabled) return null;
              const passed = scoreData.results[key];
              return <span key={key} style={{fontSize: '11px', padding: '4px 8px', borderRadius: '4px', backgroundColor: passed ? (darkMode ? '#166534' : '#bbf7d0') : (darkMode ? '#7c2d12' : '#fed7aa'), color: passed ? (darkMode ? '#bbf7d0' : '#166534') : (darkMode ? '#fed7aa' : '#7c2d12')}}>{passed ? 'âœ“' : 'âœ—'} {indicatorNames[key]} {getIndicatorCondition(key)}</span>;
            })}
          </div>
        </div>

        {/* ì„¤ì •í•˜ê¸° ë²„íŠ¼ */}
        <button onClick={() => setShowSettings(!showSettings)} style={{width: '100%', padding: '14px', borderRadius: '10px', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, backgroundColor: darkMode ? '#1e293b' : 'white', color: darkMode ? 'white' : '#111827', fontSize: '15px', fontWeight: '600', cursor: 'pointer', marginBottom: '16px'}}>
          âš™ï¸ ì„¤ì •í•˜ê¸°
        </button>

        {showSettings && (
          <div style={styles.card}>
            <h3 style={styles.sectionTitle}>ì»¤ìŠ¤í…€ ê¸°ì¤€ ë¶„ì„ ê²°ê³¼</h3>
            <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '4px 0 16px 0'}}>â€» ê° ì§€í‘œì˜ ê¸°ì¤€ê°’ê³¼ í™œì„±í™” ì—¬ë¶€ë¥¼ ì„¤ì •í•˜ì„¸ìš”</p>
            
            <div style={{marginBottom: '20px'}}>
              <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '12px'}}>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>ë‹¬ëŸ¬ ì¸ë±ìŠ¤ &lt;</label><input type="number" value={tempSettings.dollarIndex} onChange={(e) => setTempSettings({...tempSettings, dollarIndex: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>ì¬ê³ ëŸ‰ &lt;</label><input type="number" value={tempSettings.inventory} onChange={(e) => setTempSettings({...tempSettings, inventory: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
              </div>
              <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '12px'}}>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>ì¤‘êµ­ PMI &gt;</label><input type="number" value={tempSettings.pmi} onChange={(e) => setTempSettings({...tempSettings, pmi: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>MACD &gt;</label><input type="number" step="0.01" value={tempSettings.macd} onChange={(e) => setTempSettings({...tempSettings, macd: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
              </div>
              <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px'}}>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>RSI ë§¤ìˆ˜ &lt;</label><input type="number" value={tempSettings.rsiBuy} onChange={(e) => setTempSettings({...tempSettings, rsiBuy: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
                <div><label style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', display: 'block', marginBottom: '4px'}}>RSI ë§¤ë„ &gt;</label><input type="number" value={tempSettings.rsiSell} onChange={(e) => setTempSettings({...tempSettings, rsiSell: parseFloat(e.target.value)})} style={{width: '100%', padding: '8px', borderRadius: '6px', border: '1px solid #334155', backgroundColor: darkMode ? '#0f172a' : '#fff', color: darkMode ? '#fff' : '#000', boxSizing: 'border-box'}} /></div>
              </div>
            </div>
            
            <div style={{borderTop: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, paddingTop: '16px'}}>
              <div style={{fontSize: '14px', fontWeight: '600', color: darkMode ? '#e2e8f0' : '#374151', marginBottom: '12px'}}>ì§€í‘œ í™œì„±í™”</div>
              {Object.entries(tempIndicatorSettings).map(([key, setting]) => (
                <div key={key} style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '10px 0', borderBottom: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`}}>
                  <div><div style={{fontSize: '14px', color: darkMode ? 'white' : '#111827'}}>{indicatorNames[key]}</div><div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ì¡°ê±´: {getIndicatorCondition(key)}</div></div>
                  <div onClick={() => toggleTempIndicator(key)} style={{...styles.toggle, backgroundColor: setting.enabled ? '#22c55e' : (darkMode ? '#475569' : '#d1d5db')}}><div style={{...styles.toggleKnob, left: setting.enabled ? '22px' : '2px'}} /></div>
                </div>
              ))}
            </div>
            <button onClick={saveSettings} style={{width: '100%', marginTop: '20px', padding: '12px', borderRadius: '8px', border: 'none', backgroundColor: '#3b82f6', color: 'white', fontSize: '14px', fontWeight: '600', cursor: 'pointer'}}>ğŸ’¾ ì €ì¥í•˜ê¸°</button>
          </div>
        )}

        {/* ë§¤ìˆ˜ì‹œì  íˆìŠ¤í† ë¦¬ */}
        <div style={styles.card}>
          <div onClick={() => setShowHistory(!showHistory)} style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', cursor: 'pointer'}}>
            <h3 style={styles.sectionTitle}>ğŸ“… ë§¤ìˆ˜ì‹œì  íˆìŠ¤í† ë¦¬ (ìµœê·¼ 5ì¼)</h3>
            {showHistory ? <ChevronUp size={20} color={darkMode ? '#94a3b8' : '#6b7280'} /> : <ChevronDown size={20} color={darkMode ? '#94a3b8' : '#6b7280'} />}
          </div>
          {showHistory && (
            <div style={{marginTop: '12px', overflowX: 'auto'}}>
              {signalHistory.length > 0 ? (
                <table style={styles.table}>
                  <thead>
                    <tr>
                      <th style={styles.th}>ë‚ ì§œ</th>
                      <th style={styles.th}>ì‹ í˜¸</th>
                      <th style={styles.th}>ì ìˆ˜</th>
                      <th style={styles.th}>êµ¬ë¦¬ê°€ê²©</th>
                      <th style={styles.th}>ì‚¬ìš© ì§€í‘œ</th>
                    </tr>
                  </thead>
                  <tbody>
                    {signalHistory.map((h, i) => (
                      <tr key={i}>
                        <td style={styles.td}>{h.date}</td>
                        <td style={{...styles.td, color: h.signal === 'BUY' ? '#22c55e' : h.signal === 'SELL' ? '#ef4444' : '#eab308', fontWeight: 'bold'}}>{h.signal === 'BUY' ? 'ë§¤ìˆ˜' : h.signal === 'SELL' ? 'ë§¤ë„' : 'ê´€ë§'}</td>
                        <td style={styles.td}>{h.score}ì </td>
                        <td style={styles.td}>${h.price}</td>
                        <td style={{...styles.td, fontSize: '11px'}}>{h.indicators}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              ) : (
                <div style={{textAlign: 'center', padding: '20px', color: darkMode ? '#94a3b8' : '#6b7280', fontSize: '14px'}}>ì•„ì§ íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ê¸°ë¡ë©ë‹ˆë‹¤.</div>
              )}
            </div>
          )}
        </div>

        {/* ì§€í‘œ ì¹´ë“œ */}
        <div style={styles.grid}>
          {indicatorSettings.dollarIndex.enabled && <a href="https://www.investing.com/indices/usdollar" target="_blank" rel="noopener noreferrer" style={styles.metricCard}><div style={{display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px'}}><DollarSign size={14} color="#3b82f6" /><span style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ë‹¬ëŸ¬ ì¸ë±ìŠ¤</span></div><div style={styles.metricValue}>{currentData.dollarIndex}</div></a>}
          {indicatorSettings.inventory.enabled && <a href="https://en.macromicro.me/series/3613/copper-lme-warehouse-stock" target="_blank" rel="noopener noreferrer" style={styles.metricCard}><div style={{display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px'}}><Package size={14} color="#a855f7" /><span style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ì¬ê³ ëŸ‰</span></div><div style={styles.metricValue}>{Math.round(currentData.inventory).toLocaleString()}</div></a>}
          {indicatorSettings.pmi.enabled && <a href="https://www.tradingeconomics.com/china/manufacturing-pmi" target="_blank" rel="noopener noreferrer" style={styles.metricCard}><div style={{display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px'}}><Factory size={14} color="#f59e0b" /><span style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280'}}>ì¤‘êµ­ PMI</span></div><div style={styles.metricValue}>{currentData.pmi.toFixed(1)}</div></a>}
          {indicatorSettings.rsi.enabled && <a href="https://www.tradingview.com/symbols/COMEX-HG1!/technicals/" target="_blank" rel="noopener noreferrer" style={styles.metricCard}><div style={{display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px'}}><Activity size={14} color="#22c55e" /><span style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280'}}>RSI</span></div><div style={styles.metricValue}>{currentData.rsi}</div></a>}
          {indicatorSettings.macd.enabled && <a href="https://www.tradingview.com/symbols/COMEX-HG1!/technicals/" target="_blank" rel="noopener noreferrer" style={styles.metricCard}><div style={{display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px'}}><TrendingUp size={14} color="#eab308" /><span style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280'}}>MACD</span></div><div style={styles.metricValue}>{currentData.macd}</div></a>}
        </div>

        {/* êµ¬ë¦¬ ì°¨íŠ¸ */}
        <div style={styles.card}>
          <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px'}}><h3 style={styles.sectionTitle}>êµ¬ë¦¬ {getPeriodLabel(copperChartPeriod)} ì¶”ì´</h3><span onClick={() => setCopperChartExpanded(!copperChartExpanded)} style={{fontSize: '12px', color: '#3b82f6', cursor: 'pointer'}}>{copperChartExpanded ? 'ì¶•ì†Œ' : 'í™•ëŒ€'}</span></div>
          <div style={{display: 'flex', gap: '6px', marginBottom: '12px', flexWrap: 'wrap'}}>{['1w', '1m', '6m', '1y', '10y'].map(p => <button key={p} onClick={() => setCopperChartPeriod(p)} style={getTabStyle(copperChartPeriod === p)}>{getPeriodLabel(p)}</button>)}</div>
          <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '0 0 12px 0'}}>â€» ì‹¤ì œ ê°€ê²© ($/lb) - í´ë¦­í•˜ì—¬ {copperChartExpanded ? 'ì¶•ì†Œ' : 'í™•ëŒ€'}</p>
          <div onClick={() => setCopperChartExpanded(!copperChartExpanded)} style={{cursor: 'pointer'}}><ResponsiveContainer width="100%" height={copperChartExpanded ? 360 : 180}><LineChart data={getFilteredData(copperChartPeriod)}><CartesianGrid strokeDasharray="3 3" stroke={darkMode ? '#334155' : '#e5e7eb'} /><XAxis dataKey="date" stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 9}} /><YAxis stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 10}} domain={['auto', 'auto']} /><Tooltip content={({active, payload, label}) => { if (active && payload && payload.length) { return <div style={{backgroundColor: darkMode ? '#1e293b' : '#fff', padding: '8px 12px', borderRadius: '6px', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, fontSize: '12px'}}><div style={{color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '4px'}}>{label}</div><div style={{color: '#60a5fa', fontWeight: 'bold'}}>êµ¬ë¦¬: ${payload[0].value}</div></div>; } return null; }} /><Line type="monotone" dataKey="copper" stroke="#60a5fa" strokeWidth={2} dot={false} /></LineChart></ResponsiveContainer></div>
        </div>

        {/* ì€ ì°¨íŠ¸ */}
        <div style={styles.card}>
          <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px'}}><h3 style={styles.sectionTitle}>ì€ {getPeriodLabel(silverChartPeriod)} ì¶”ì´</h3><span onClick={() => setSilverChartExpanded(!silverChartExpanded)} style={{fontSize: '12px', color: '#3b82f6', cursor: 'pointer'}}>{silverChartExpanded ? 'ì¶•ì†Œ' : 'í™•ëŒ€'}</span></div>
          <div style={{display: 'flex', gap: '6px', marginBottom: '12px', flexWrap: 'wrap'}}>{['1w', '1m', '6m', '1y', '10y'].map(p => <button key={p} onClick={() => setSilverChartPeriod(p)} style={getTabStyle(silverChartPeriod === p)}>{getPeriodLabel(p)}</button>)}</div>
          <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '0 0 12px 0'}}>â€» êµ¬ë¦¬ì™€ ìƒê´€ê´€ê³„ 0.82 - í´ë¦­í•˜ì—¬ {silverChartExpanded ? 'ì¶•ì†Œ' : 'í™•ëŒ€'}</p>
          <div onClick={() => setSilverChartExpanded(!silverChartExpanded)} style={{cursor: 'pointer'}}><ResponsiveContainer width="100%" height={silverChartExpanded ? 360 : 180}><LineChart data={getFilteredData(silverChartPeriod, silverData)}><CartesianGrid strokeDasharray="3 3" stroke={darkMode ? '#334155' : '#e5e7eb'} /><XAxis dataKey="date" stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 9}} /><YAxis stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 10}} domain={['auto', 'auto']} /><Tooltip content={({active, payload, label}) => { if (active && payload && payload.length) { return <div style={{backgroundColor: darkMode ? '#1e293b' : '#fff', padding: '8px 12px', borderRadius: '6px', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, fontSize: '12px'}}><div style={{color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '4px'}}>{label}</div><div style={{color: '#94a3b8', fontWeight: 'bold'}}>ì€: ${payload[0].value}</div></div>; } return null; }} /><Line type="monotone" dataKey="silver" stroke="#94a3b8" strokeWidth={2} dot={false} /></LineChart></ResponsiveContainer></div>
        </div>

        {/* ì•„ì—° ì‹œì„¸ ë§í¬ */}
        <a href="https://kr.investing.com/commodities/zinc" target="_blank" rel="noopener noreferrer" style={{...styles.card, textDecoration: 'none', display: 'flex', alignItems: 'center', justifyContent: 'space-between', backgroundColor: darkMode ? '#1e3a8a' : '#dbeafe', border: `1px solid ${darkMode ? '#3b82f6' : '#93c5fd'}`}}>
          <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}><span style={{fontSize: '20px'}}>ğŸ“Š</span><div><div style={{color: darkMode ? 'white' : '#1e40af', fontSize: '14px', fontWeight: '600'}}>ì•„ì—° ì„ ë¬¼ ì‹œì„¸</div><div style={{color: darkMode ? '#93c5fd' : '#3b82f6', fontSize: '11px'}}>Investing.comì—ì„œ ì‹¤ì‹œê°„ í™•ì¸ (êµ¬ë¦¬ ìƒê´€ê´€ê³„ 0.75)</div></div></div>
          <ExternalLink size={16} color={darkMode ? '#93c5fd' : '#3b82f6'} />
        </a>

        {/* ê¸ˆ ì°¨íŠ¸ */}
        <div style={styles.card}>
          <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px'}}><h3 style={styles.sectionTitle}>ê¸ˆ {getPeriodLabel(goldChartPeriod)} ì¶”ì´</h3><span onClick={() => setGoldChartExpanded(!goldChartExpanded)} style={{fontSize: '12px', color: '#3b82f6', cursor: 'pointer'}}>{goldChartExpanded ? 'ì¶•ì†Œ' : 'í™•ëŒ€'}</span></div>
          <div style={{display: 'flex', gap: '6px', marginBottom: '12px', flexWrap: 'wrap'}}>{['1w', '1m', '6m', '1y', '10y'].map(p => <button key={p} onClick={() => setGoldChartPeriod(p)} style={getTabStyle(goldChartPeriod === p)}>{getPeriodLabel(p)}</button>)}</div>
          <p style={{fontSize: '11px', color: darkMode ? '#f59e0b' : '#d97706', margin: '0 0 12px 0', backgroundColor: darkMode ? '#422006' : '#fef3c7', padding: '8px', borderRadius: '6px'}}>âš ï¸ ê¸ˆì€ ì•ˆì „ìì‚°ìœ¼ë¡œ êµ¬ë¦¬(ì‚°ì—…ìš©)ì™€ ìƒê´€ê´€ê³„ê°€ ë‚®ìŠµë‹ˆë‹¤. ì°¸ê³ ìš©ìœ¼ë¡œë§Œ í™œìš©í•˜ì„¸ìš”.</p>
          <div onClick={() => setGoldChartExpanded(!goldChartExpanded)} style={{cursor: 'pointer'}}><ResponsiveContainer width="100%" height={goldChartExpanded ? 360 : 180}><LineChart data={getFilteredData(goldChartPeriod)}><CartesianGrid strokeDasharray="3 3" stroke={darkMode ? '#334155' : '#e5e7eb'} /><XAxis dataKey="date" stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 9}} /><YAxis stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 10}} domain={['auto', 'auto']} /><Tooltip content={({active, payload, label}) => { if (active && payload && payload.length) { return <div style={{backgroundColor: darkMode ? '#1e293b' : '#fff', padding: '8px 12px', borderRadius: '6px', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, fontSize: '12px'}}><div style={{color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '4px'}}>{label}</div><div style={{color: '#fbbf24', fontWeight: 'bold'}}>ê¸ˆ: ${payload[0].value}</div></div>; } return null; }} /><Line type="monotone" dataKey="gold" stroke="#fbbf24" strokeWidth={2} dot={false} /></LineChart></ResponsiveContainer></div>
        </div>

        {/* í•œêµ­ì—ì„œ êµ¬ë¦¬ íˆ¬ì - í‘œ í˜•ì‹ */}
        <div style={styles.card}>
          <div style={{display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px'}}><span style={{fontSize: '18px'}}>ğŸ‡°ğŸ‡·</span><h3 style={styles.sectionTitle}>í•œêµ­ì—ì„œ êµ¬ë¦¬ íˆ¬ì</h3></div>
          <div style={{overflowX: 'auto'}}>
            <table style={styles.table}>
              <thead>
                <tr>
                  <th style={styles.th}>ì¢…ë¥˜</th>
                  <th style={styles.th}>ì¢…ëª©ëª…</th>
                  <th style={styles.th}>ì½”ë“œ</th>
                  <th style={styles.th}>ì‹œì„¸</th>
                </tr>
              </thead>
              <tbody>
                {krStocks.map((stock, i) => (
                  <tr key={i}>
                    <td style={styles.td}>{stock.type}</td>
                    <td style={{...styles.td, fontWeight: '500'}}>{stock.name}</td>
                    <td style={styles.td}>{stock.code}</td>
                    <td style={styles.td}><a href={stock.url} target="_blank" rel="noopener noreferrer" style={{color: '#3b82f6', textDecoration: 'none', fontWeight: '500'}}>í™•ì¸ â†’</a></td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '12px 0 0 0'}}>â€» ê°ì ì¦ê¶Œì‚¬ ì•±ì—ì„œ ê²€ìƒ‰í•˜ì—¬ ë§¤ìˆ˜í•˜ì„¸ìš”</p>
        </div>

        {/* ë‰´ìŠ¤ */}
        <div style={styles.card}>
          <div style={{display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px'}}><Newspaper size={16} color="#3b82f6" /><h3 style={styles.sectionTitle}>ì‹¤ì‹œê°„ ë‰´ìŠ¤</h3></div>
          
          <a href="https://kr.investing.com/commodities/copper" target="_blank" rel="noopener noreferrer" style={{...styles.newsItem, textDecoration: 'none', display: 'flex', alignItems: 'center', justifyContent: 'space-between', backgroundColor: darkMode ? '#1e3a8a' : '#dbeafe', border: `1px solid ${darkMode ? '#3b82f6' : '#93c5fd'}`, marginBottom: '10px'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}><span style={{fontSize: '20px'}}>ğŸ“Š</span><div><div style={{color: darkMode ? 'white' : '#1e40af', fontSize: '14px', fontWeight: '600'}}>êµ¬ë¦¬ ì„ ë¬¼ ì‹œì„¸</div><div style={{color: darkMode ? '#93c5fd' : '#3b82f6', fontSize: '11px'}}>Investing.comì—ì„œ ì‹¤ì‹œê°„ í™•ì¸</div></div></div>
            <ExternalLink size={16} color={darkMode ? '#93c5fd' : '#3b82f6'} />
          </a>
          
          <a href="https://search.naver.com/search.naver?where=news&query=êµ¬ë¦¬+ì›ìì¬" target="_blank" rel="noopener noreferrer" style={{...styles.newsItem, textDecoration: 'none', display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '10px'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}><span style={{fontSize: '20px'}}>ğŸ“°</span><div><div style={{color: darkMode ? 'white' : '#111827', fontSize: '14px', fontWeight: '600'}}>êµ¬ë¦¬ ê´€ë ¨ ë‰´ìŠ¤</div><div style={{color: darkMode ? '#94a3b8' : '#6b7280', fontSize: '11px'}}>ë„¤ì´ë²„ ë‰´ìŠ¤ì—ì„œ í™•ì¸</div></div></div>
            <ExternalLink size={16} color={darkMode ? '#94a3b8' : '#6b7280'} />
          </a>
          
          <a href="https://kr.investing.com/commodities/copper-news" target="_blank" rel="noopener noreferrer" style={{...styles.newsItem, textDecoration: 'none', display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '10px'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}><span style={{fontSize: '20px'}}>ğŸŒ</span><div><div style={{color: darkMode ? 'white' : '#111827', fontSize: '14px', fontWeight: '600'}}>êµ¬ë¦¬ ë‰´ìŠ¤ (í•œêµ­ì–´)</div><div style={{color: darkMode ? '#94a3b8' : '#6b7280', fontSize: '11px'}}>Investing.com í•œêµ­ì–´ ë‰´ìŠ¤</div></div></div>
            <ExternalLink size={16} color={darkMode ? '#94a3b8' : '#6b7280'} />
          </a>
          
          <a href="https://finance.yahoo.com/quote/HG=F/news/" target="_blank" rel="noopener noreferrer" style={{...styles.newsItem, textDecoration: 'none', display: 'flex', alignItems: 'center', justifyContent: 'space-between'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '10px'}}><span style={{fontSize: '20px'}}>ğŸ‡ºğŸ‡¸</span><div><div style={{color: darkMode ? 'white' : '#111827', fontSize: '14px', fontWeight: '600'}}>êµ¬ë¦¬ ë‰´ìŠ¤ (ì˜ì–´)</div><div style={{color: darkMode ? '#94a3b8' : '#6b7280', fontSize: '11px'}}>Yahoo Finance ì˜ì–´ ë‰´ìŠ¤</div></div></div>
            <ExternalLink size={16} color={darkMode ? '#94a3b8' : '#6b7280'} />
          </a>
        </div>

        {/* ì¶”ê°€ ì •ë³´ ë²„íŠ¼ 3ê°œ */}
        <div style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '10px', marginBottom: '16px'}}>
          <button onClick={() => setShowStocksGuide(!showStocksGuide)} style={{padding: '14px 8px', borderRadius: '12px', border: `2px solid ${showStocksGuide ? '#3b82f6' : (darkMode ? '#334155' : '#e5e7eb')}`, backgroundColor: showStocksGuide ? (darkMode ? '#1e3a8a' : '#dbeafe') : (darkMode ? '#1e293b' : 'white'), color: showStocksGuide ? '#3b82f6' : (darkMode ? 'white' : '#111827'), fontSize: '13px', fontWeight: '600', cursor: 'pointer', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '6px'}}>
            <span style={{fontSize: '24px'}}>ğŸ“‹</span>
            <span>ì¢…ëª© ê°€ì´ë“œ</span>
          </button>
          <button onClick={() => setShowPortfolio(!showPortfolio)} style={{padding: '14px 8px', borderRadius: '12px', border: `2px solid ${showPortfolio ? '#22c55e' : (darkMode ? '#334155' : '#e5e7eb')}`, backgroundColor: showPortfolio ? (darkMode ? '#14532d' : '#dcfce7') : (darkMode ? '#1e293b' : 'white'), color: showPortfolio ? '#22c55e' : (darkMode ? 'white' : '#111827'), fontSize: '13px', fontWeight: '600', cursor: 'pointer', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '6px'}}>
            <span style={{fontSize: '24px'}}>ğŸ’¼</span>
            <span>í¬íŠ¸í´ë¦¬ì˜¤</span>
          </button>
          <button onClick={() => setShowInvestGuide(!showInvestGuide)} style={{padding: '14px 8px', borderRadius: '12px', border: `2px solid ${showInvestGuide ? '#f59e0b' : (darkMode ? '#334155' : '#e5e7eb')}`, backgroundColor: showInvestGuide ? (darkMode ? '#78350f' : '#fef3c7') : (darkMode ? '#1e293b' : 'white'), color: showInvestGuide ? '#f59e0b' : (darkMode ? 'white' : '#111827'), fontSize: '13px', fontWeight: '600', cursor: 'pointer', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '6px'}}>
            <span style={{fontSize: '24px'}}>ğŸ“š</span>
            <span>íˆ¬ì ê°€ì´ë“œ</span>
          </button>
        </div>

        {/* ì¢…ëª© ê°€ì´ë“œ ë‚´ìš© */}
        {showStocksGuide && (
        <>
          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>âœ… êµ¬ë¦¬ ê´€ë ¨ ETF / ETN</h3>
            <p style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '16px'}}>êµ¬ë¦¬ ì‚°ì—… ì „ì²´ë¥¼ ë¬¶ì–´ì„œ íˆ¬ìí•˜ëŠ” ìƒí’ˆ</p>
            <div style={{overflowX: 'auto'}}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>íˆ¬ì ëŒ€ìƒ</th>
                    <th style={styles.th}>ëŒ€í‘œ ìƒí’ˆ</th>
                    <th style={styles.th}>í‹°ì»¤</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style={styles.td}>êµ¬ë¦¬ ê´‘ì‚°/ìƒì‚° ê¸°ì—… ETF</td><td style={styles.td}>Global X Copper Miners ETF</td><td style={{...styles.td, fontWeight: 'bold', color: '#3b82f6'}}>COPX</td></tr>
                  <tr><td style={styles.td}>êµ¬ë¦¬ ì±„êµ´ ETF (ëŒ€ì²´)</td><td style={styles.td}>Sprott Copper Miners ETF</td><td style={{...styles.td, fontWeight: 'bold', color: '#3b82f6'}}>COPP</td></tr>
                  <tr><td style={styles.td}>êµ¬ë¦¬ ì„ ë¬¼ ê¸°ë°˜ ETF</td><td style={styles.td}>ë¯¸êµ­ êµ¬ë¦¬ ì„ ë¬¼ ì¶”ì¢… ETF</td><td style={{...styles.td, fontWeight: 'bold', color: '#3b82f6'}}>CPER</td></tr>
                  <tr><td style={styles.td}>iShares êµ¬ë¦¬/ê¸ˆì† ë§ˆì´ë‹ ETF</td><td style={styles.td}>ê´‘ì‚° í¬í•¨ ETF</td><td style={{...styles.td, fontWeight: 'bold', color: '#3b82f6'}}>ICOP</td></tr>
                </tbody>
              </table>
            </div>
            <div style={{marginTop: '12px', padding: '10px', backgroundColor: darkMode ? '#1e3a8a' : '#dbeafe', borderRadius: '8px', fontSize: '12px', color: darkMode ? '#93c5fd' : '#1e40af'}}>
              â­ COPXëŠ” ì „ì„¸ê³„ êµ¬ë¦¬ ì±„êµ´/ìƒì‚° ê¸°ì—… ì£¼ì‹ ë°”ìŠ¤ì¼“ ETFë¡œ ëŒ€í‘œì ì„<br/>â†’ ì—¬ëŸ¬ ê´‘ì‚°ì‚¬ ì£¼ì‹ì„ í•œ ë²ˆì— ë‹´ì•„ ë¶„ì‚° íš¨ê³¼ ìˆì–´ìš”
            </div>
          </div>

          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸª™ êµ¬ë¦¬ ê´‘ì‚°Â·ì±„êµ´ ê´€ë ¨ ê°œë³„ì£¼</h3>
            <p style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '16px'}}>ETFê°€ ë‹´ê³  ìˆê±°ë‚˜ ì—…ê³„ì—ì„œ ëŒ€í‘œì ìœ¼ë¡œ ê¼½íˆëŠ” ì¢…ëª©ë“¤</p>
            <div style={{overflowX: 'auto'}}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>ê¸°ì—…ëª…</th>
                    <th style={styles.th}>í‹°ì»¤</th>
                    <th style={styles.th}>ì„¤ëª…</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style={styles.td}>Freeport-McMoRan</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>FCX</td><td style={styles.td}>ë¯¸êµ­ ëŒ€í‘œ êµ¬ë¦¬Â·ê¸ˆ ì±„êµ´ (ì„¸ê³„ ìµœëŒ€ê¸‰)</td></tr>
                  <tr><td style={styles.td}>Southern Copper</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>SCCO</td><td style={styles.td}>ë¯¸êµ­/ë¼í‹´ì•„ë©”ë¦¬ì¹´ ëŒ€í˜• êµ¬ë¦¬ ìƒì‚°ì‚¬</td></tr>
                  <tr><td style={styles.td}>KGHM Polska Miedz</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>KGH</td><td style={styles.td}>í´ë€ë“œ êµ¬ë¦¬ ìƒì‚°ì‚¬, COPX ì£¼ìš” í¸ì…</td></tr>
                  <tr><td style={styles.td}>Lundin Mining</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>LUN</td><td style={styles.td}>ìºë‚˜ë‹¤ êµ¬ë¦¬/ê¸ˆì† ì±„êµ´ ê¸°ì—…</td></tr>
                  <tr><td style={styles.td}>Antofagasta plc</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>ANTO</td><td style={styles.td}>ì¹ ë ˆ ê´‘ì‚° ê¸°ì—…, êµ¬ë¦¬ ìƒì‚° ë¹„ì¤‘ í¼</td></tr>
                  <tr><td style={styles.td}>First Quantum</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>FM</td><td style={styles.td}>ìºë‚˜ë‹¤ êµ¬ë¦¬Â·ë‹ˆì¼ˆ ë“± ê´‘ì‚°ì—…ì²´</td></tr>
                  <tr><td style={styles.td}>Teck Resources</td><td style={{...styles.td, fontWeight: 'bold', color: '#22c55e'}}>TECK</td><td style={styles.td}>ìºë‚˜ë‹¤ ê¸ˆì†/ì—ë„ˆì§€ ê´‘ì‚°ì‚¬</td></tr>
                </tbody>
              </table>
            </div>
            <div style={{marginTop: '12px', padding: '10px', backgroundColor: darkMode ? '#14532d' : '#dcfce7', borderRadius: '8px', fontSize: '12px', color: darkMode ? '#86efac' : '#166534'}}>
              ğŸ’¡ ì´ë“¤ ê¸°ì—…ì€ ê¸€ë¡œë²Œ êµ¬ë¦¬ ETF(COPX/COPP)ì— ìƒìœ„ í¸ì… ë¹„ì¤‘ìœ¼ë¡œ í¬í•¨ë©ë‹ˆë‹¤
            </div>
          </div>
        </>
        )}

        {/* í¬íŠ¸í´ë¦¬ì˜¤ ë‚´ìš© */}
        {showPortfolio && (
        <>
          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸ¢ êµ¬ë¦¬ ì„¹í„° í˜¼í•© í¬íŠ¸í´ë¦¬ì˜¤ ì˜ˆì‹œ</h3>
            <div style={{overflowX: 'auto'}}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>êµ¬ë¶„</th>
                    <th style={styles.th}>íˆ¬ì ëŒ€ìƒ</th>
                    <th style={styles.th}>í‹°ì»¤</th>
                    <th style={styles.th}>ë¹„ì¤‘</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style={styles.td}>êµ­ë‚´ ETF</td><td style={styles.td}>KODEX êµ¬ë¦¬ì„ ë¬¼(H)</td><td style={{...styles.td, fontWeight: 'bold'}}>229240</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>20%</td></tr>
                  <tr><td style={styles.td}>êµ­ë‚´ ETF</td><td style={styles.td}>TIGER êµ¬ë¦¬ì„ ë¬¼(H)</td><td style={{...styles.td, fontWeight: 'bold'}}>302430</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>10%</td></tr>
                  <tr><td style={styles.td}>í•´ì™¸ ETF</td><td style={styles.td}>Global X Copper Miners</td><td style={{...styles.td, fontWeight: 'bold'}}>COPX</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>20%</td></tr>
                  <tr><td style={styles.td}>í•´ì™¸ ETF</td><td style={styles.td}>Sprott Copper Miners</td><td style={{...styles.td, fontWeight: 'bold'}}>COPP</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>10%</td></tr>
                  <tr><td style={styles.td}>ê°œë³„ì£¼</td><td style={styles.td}>Freeport-McMoRan</td><td style={{...styles.td, fontWeight: 'bold'}}>FCX</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>10%</td></tr>
                  <tr><td style={styles.td}>ê°œë³„ì£¼</td><td style={styles.td}>Southern Copper</td><td style={{...styles.td, fontWeight: 'bold'}}>SCCO</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>5%</td></tr>
                  <tr><td style={styles.td}>êµ­ë‚´ ìˆ˜í˜œì£¼</td><td style={styles.td}>í’ì‚°</td><td style={{...styles.td, fontWeight: 'bold'}}>103140</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>5%</td></tr>
                  <tr><td style={styles.td}>í˜„ê¸ˆ/ë‹¨ê¸°ì±„</td><td style={styles.td}>MMF / ë‹¨ê¸°ì±„ ETF</td><td style={{...styles.td, fontWeight: 'bold'}}>-</td><td style={{...styles.td, color: '#3b82f6', fontWeight: 'bold'}}>10%</td></tr>
                </tbody>
              </table>
            </div>
          </div>

          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸ”„ ì¸ë²„ìŠ¤ í¬í•¨ í¬íŠ¸í´ë¦¬ì˜¤</h3>
            <p style={{fontSize: '12px', color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '16px'}}>í•˜ë½ì¥ ëŒ€ë¹„ ì¸ë²„ìŠ¤ ETF í¬í•¨ êµ¬ì„±</p>
            <div style={{overflowX: 'auto'}}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>êµ¬ë¶„</th>
                    <th style={styles.th}>íˆ¬ì ëŒ€ìƒ</th>
                    <th style={styles.th}>í‹°ì»¤</th>
                    <th style={styles.th}>ë¹„ì¤‘</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style={styles.td}>êµ­ë‚´ ETF</td><td style={styles.td}>KODEX êµ¬ë¦¬ì„ ë¬¼(H)</td><td style={{...styles.td, fontWeight: 'bold'}}>229240</td><td style={{...styles.td, color: '#22c55e', fontWeight: 'bold'}}>20%</td></tr>
                  <tr><td style={{...styles.td, color: '#ef4444'}}>ì¸ë²„ìŠ¤ ETF</td><td style={styles.td}>KBSTAR êµ¬ë¦¬ì„ ë¬¼ì¸ë²„ìŠ¤</td><td style={{...styles.td, fontWeight: 'bold'}}>305720</td><td style={{...styles.td, color: '#ef4444', fontWeight: 'bold'}}>10%</td></tr>
                  <tr><td style={styles.td}>í•´ì™¸ ETF</td><td style={styles.td}>COPX</td><td style={{...styles.td, fontWeight: 'bold'}}>COPX</td><td style={{...styles.td, color: '#22c55e', fontWeight: 'bold'}}>15%</td></tr>
                  <tr><td style={styles.td}>ê°œë³„ì£¼</td><td style={styles.td}>Freeport-McMoRan</td><td style={{...styles.td, fontWeight: 'bold'}}>FCX</td><td style={{...styles.td, color: '#22c55e', fontWeight: 'bold'}}>10%</td></tr>
                  <tr><td style={styles.td}>í˜„ê¸ˆ/ë‹¨ê¸°ì±„</td><td style={styles.td}>MMF</td><td style={{...styles.td, fontWeight: 'bold'}}>-</td><td style={{...styles.td, color: '#22c55e', fontWeight: 'bold'}}>10%</td></tr>
                </tbody>
              </table>
            </div>
            <div style={{marginTop: '12px', padding: '10px', backgroundColor: darkMode ? '#7c2d12' : '#fef3c7', borderRadius: '8px', fontSize: '12px', color: darkMode ? '#fed7aa' : '#92400e'}}>
              âš ï¸ ì¸ë²„ìŠ¤ ETFëŠ” êµ¬ë¦¬ ê°€ê²© í•˜ë½ ì‹œ ìˆ˜ìµ, ì¥ê¸°ë³´ë‹¤ëŠ” ë‹¨ê¸°/ì¤‘ê¸° ì „ëµìš©
            </div>
          </div>
        </>
        )}

        {/* íˆ¬ì ê°€ì´ë“œ ë‚´ìš© */}
        {showInvestGuide && (
        <>
          <div style={{...styles.card, background: darkMode ? 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)' : 'linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)'}}>
            <h3 style={{color: darkMode ? 'white' : '#92400e', fontWeight: 'bold', fontSize: '16px', marginBottom: '12px'}}>ğŸ”° ì´ˆë³´ììš© 5ì¤„ ìš”ì•½ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
            <div style={{fontSize: '13px', color: darkMode ? 'white' : '#78350f', lineHeight: '2'}}>
              <div>â€¢ ë‹¬ëŸ¬ ì•½ì„¸(DXYâ†“) â†’ êµ¬ë¦¬ ê°•ì„¸ ê°€ëŠ¥ â†‘</div>
              <div>â€¢ ë¯¸êµ­ ê¸ˆë¦¬ ì¸í•˜ ê¸°ëŒ€â†‘ â†’ êµ¬ë¦¬ â†‘</div>
              <div>â€¢ ì¤‘êµ­ ì œì¡°ì—… PMI {'>'} 50 â†’ ìˆ˜ìš”â†‘ â†’ êµ¬ë¦¬ â†‘</div>
              <div>â€¢ LME êµ¬ë¦¬ ì¬ê³  ê°ì†Œ â†’ ê³µê¸‰ ë¶€ì¡± â†’ êµ¬ë¦¬ â†‘</div>
              <div style={{marginTop: '8px', fontSize: '11px', opacity: 0.9}}>â€» ìœ„ 3ìš”ì†Œ(ë‹¬ëŸ¬Â·ì¤‘êµ­Â·ì¬ê³ )ê°€ êµ¬ë¦¬ì˜ ì „ë¶€ë¼ê³  ë´ë„ ë¨</div>
            </div>
          </div>

          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸ”´ êµ¬ë¦¬ì„ ë¬¼ ETF ì‹¤ì „ ë§¤ë§¤ ê¸°ì¤€</h3>
            <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px'}}>
              <div style={{padding: '12px', backgroundColor: darkMode ? '#14532d' : '#dcfce7', borderRadius: '8px'}}>
                <div style={{fontWeight: 'bold', color: darkMode ? '#86efac' : '#166534', marginBottom: '8px'}}>ë§¤ìˆ˜ íƒ€ì´ë°</div>
                <div style={{fontSize: '12px', color: darkMode ? '#bbf7d0' : '#15803d', lineHeight: '1.8'}}>
                  <div>ğŸŸ¢ ë‹¬ëŸ¬ ì•½ì„¸ í¬ì°©</div>
                  <div>ğŸŸ¢ ì¤‘êµ­ PMI 50 ì´ìƒ</div>
                  <div>ğŸŸ¢ LME ì¬ê³  ê°ì†Œ</div>
                </div>
              </div>
              <div style={{padding: '12px', backgroundColor: darkMode ? '#7c2d12' : '#fee2e2', borderRadius: '8px'}}>
                <div style={{fontWeight: 'bold', color: darkMode ? '#fca5a5' : '#dc2626', marginBottom: '8px'}}>ë§¤ë„ íƒ€ì´ë°</div>
                <div style={{fontSize: '12px', color: darkMode ? '#fecaca' : '#b91c1c', lineHeight: '1.8'}}>
                  <div>ğŸ”´ ë‹¬ëŸ¬ 105 ì´ìƒ</div>
                  <div>ğŸ”´ PMI 50 ì•„ë˜ë¡œ</div>
                  <div>ğŸ”´ LME ì¬ê³  ì¦ê°€</div>
                </div>
              </div>
            </div>
          </div>

          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸ• êµ¬ë¦¬ ê°€ê²© 5ê°€ì§€ í•µì‹¬ ë³€ìˆ˜</h3>
            <div style={{display: 'grid', gap: '8px'}}>
              {[
                { icon: 'ğŸ’µ', name: 'DXY (ë‹¬ëŸ¬ì§€ìˆ˜)', desc: 'ë‹¬ëŸ¬ ì•½ì„¸ ì‹œ êµ¬ë¦¬ ê°•ì„¸' },
                { icon: 'ğŸ­', name: 'ì¤‘êµ­ ì œì¡°ì—… PMI', desc: '50 ì´ìƒì´ë©´ ìˆ˜ìš” ì¦ê°€' },
                { icon: 'ğŸ“¦', name: 'LME êµ¬ë¦¬ ì¬ê³ ', desc: 'ì¬ê³  ê°ì†Œ ì‹œ ê°€ê²© ìƒìŠ¹' },
                { icon: 'ğŸ›ï¸', name: 'ë¯¸êµ­ ê¸ˆë¦¬ì •ì±…', desc: 'ê¸ˆë¦¬ ì¸í•˜ ê¸°ëŒ€ ì‹œ ìƒìŠ¹' },
                { icon: 'âš¡', name: 'ì „ë ¥ë‚œÂ·ê´‘ì‚° ì´ìŠˆ', desc: 'ê³µê¸‰ ì°¨ì§ˆ ì‹œ ê°€ê²© ê¸‰ë“±' }
              ].map((item, i) => (
                <div key={i} style={{display: 'flex', alignItems: 'center', gap: '12px', padding: '10px', backgroundColor: darkMode ? '#0f172a' : '#f3f4f6', borderRadius: '8px'}}>
                  <span style={{fontSize: '20px'}}>{item.icon}</span>
                  <div>
                    <div style={{fontWeight: 'bold', color: darkMode ? 'white' : '#111827', fontSize: '13px'}}>{item.name}</div>
                    <div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280'}}>{item.desc}</div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <div style={styles.card}>
            <h3 style={{...styles.sectionTitle, marginBottom: '16px'}}>ğŸ“Š êµ¬ë¦¬ ì „ë§ (2025~2035)</h3>
            <div style={{overflowX: 'auto'}}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>ê¸°ê´€</th>
                    <th style={styles.th}>ê¸°ê°„</th>
                    <th style={styles.th}>ê°€ê²© ì „ë§</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style={styles.td}>J.P. Morgan</td><td style={styles.td}>2025â†’2026</td><td style={styles.td}>$10,875 â†’ $12,500/í†¤</td></tr>
                  <tr><td style={styles.td}>Goldman Sachs</td><td style={styles.td}>2026</td><td style={styles.td}>í‰ê·  $10,710</td></tr>
                  <tr><td style={styles.td}>Grand View</td><td style={styles.td}>2025â†’2030</td><td style={styles.td}>$248B â†’ $339.9B</td></tr>
                </tbody>
              </table>
            </div>
            <div style={{marginTop: '12px', padding: '10px', backgroundColor: darkMode ? '#1e3a8a' : '#dbeafe', borderRadius: '8px', fontSize: '12px', color: darkMode ? '#93c5fd' : '#1e40af', textAlign: 'center'}}>
              ğŸ“ˆ ì°¨ê¸° ìƒìŠ¹ ì‚¬ì´í´ 2024-2027 ì˜ˆìƒ
            </div>
          </div>
        </>
        )}

        {/* ìƒê´€ê´€ê³„ */}
        <div style={styles.card}>
          <h3 style={styles.sectionTitle}>ì›ìì¬ ìƒê´€ê´€ê³„ (ì°¸ê³ ìš©)</h3>
          <p style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', margin: '0 0 12px 0'}}>â€» ê³¼ê±° í‰ê·  ê¸°ì¤€, ì‹¤ì‹œê°„ ì•„ë‹˜<br/>(1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ êµ¬ë¦¬ì™€ í•¨ê»˜ ì›€ì§ì¼ í™•ë¥  ë†’ìŒ)</p>
          <ResponsiveContainer width="100%" height={140}><BarChart data={correlationData}><CartesianGrid strokeDasharray="3 3" stroke={darkMode ? '#334155' : '#e5e7eb'} /><XAxis dataKey="name" stroke={darkMode ? '#94a3b8' : '#6b7280'} style={{fontSize: 10}} /><YAxis stroke={darkMode ? '#94a3b8' : '#6b7280'} domain={[0, 1]} style={{fontSize: 10}} /><Tooltip contentStyle={{ backgroundColor: darkMode ? '#1e293b' : '#fff', fontSize: 11 }} /><Bar dataKey="correlation" fill="#3b82f6" /></BarChart></ResponsiveContainer>
          <div style={{marginTop: '12px', display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '8px'}}>{correlationData.map((item, i) => <div key={i} style={{...styles.metricCard, cursor: 'default', padding: '8px'}}><div style={{fontSize: '11px', color: darkMode ? '#94a3b8' : '#6b7280', marginBottom: '4px'}}>{item.name}</div><div style={{fontSize: '16px', fontWeight: 'bold', color: darkMode ? 'white' : '#111827'}}>${item.price}</div></div>)}</div>
        </div>

        {/* í‘¸í„° */}
        <div style={{marginTop: '24px', paddingTop: '20px', borderTop: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`}}>
          <button onClick={() => setShowAppGuide(!showAppGuide)} style={{width: '100%', padding: '14px', borderRadius: '10px', border: `1px solid ${darkMode ? '#334155' : '#e5e7eb'}`, backgroundColor: darkMode ? '#1e293b' : 'white', color: darkMode ? 'white' : '#111827', fontSize: '15px', fontWeight: '600', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', marginBottom: '16px'}}>ğŸ’¡ ì•± ì†Œê°œ {showAppGuide ? <ChevronUp size={18} /> : <ChevronDown size={18} />}</button>
          {showAppGuide && (
            <div style={{...styles.card, backgroundColor: darkMode ? '#0f172a' : '#f9fafb', marginBottom: '16px'}}>
              <div style={{backgroundColor: darkMode ? '#1e3a8a' : '#dbeafe', padding: '14px', borderRadius: '8px', marginBottom: '20px', border: `1px solid ${darkMode ? '#3b82f6' : '#93c5fd'}`}}><div style={{fontSize: '15px', fontWeight: '600', color: darkMode ? '#93c5fd' : '#1e40af', marginBottom: '10px'}}>ğŸ“Œ ì‹œì‘í•˜ê¸°</div><div style={{fontSize: '13px', color: darkMode ? '#bfdbfe' : '#1e40af', lineHeight: '1.7'}}>ì•±ì„ ì‹œì‘í•˜ë©´ ìë™ìœ¼ë¡œ ìµœì‹  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. ìˆ˜ë™ ê°±ì‹ ì€ ğŸ”„ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.<br/><br/><span style={{fontSize: '11px', opacity: 0.8}}>* êµ¬ë¦¬/ê¸ˆ/ì•„ì—° ê°€ê²©, ë‹¬ëŸ¬ ì¸ë±ìŠ¤, RSI, MACDëŠ” ì‹¤ì‹œê°„ ë°ì´í„°ì…ë‹ˆë‹¤.<br/>* ì¤‘êµ­ PMI, ì¬ê³ ëŸ‰ì€ ì›”ê°„/ì£¼ê°„ ë°œí‘œ ë°ì´í„°ì…ë‹ˆë‹¤.<br/>* ì£¼ë§ì—ëŠ” ê¸ˆìš”ì¼ ë§ˆê°ê°€ê°€ í‘œì‹œë©ë‹ˆë‹¤.</span></div></div>
              <div style={{marginBottom: '20px'}}><div style={{fontSize: '15px', fontWeight: '600', color: darkMode ? '#60a5fa' : '#2563eb', marginBottom: '12px'}}>ğŸ“Š ì ìˆ˜ ê¸°ì¤€</div><div style={{fontSize: '13px', color: darkMode ? '#e2e8f0' : '#374151', lineHeight: '1.8'}}><div style={{marginBottom: '6px'}}>â€¢ <strong style={{color: '#22c55e'}}>80ì  ì´ìƒ</strong>: ì ê·¹ ë§¤ìˆ˜ ê¶Œì¥</div><div style={{marginBottom: '6px'}}>â€¢ <strong style={{color: '#22c55e'}}>60~79ì </strong>: ë§¤ìˆ˜ ì í•©</div><div style={{marginBottom: '6px'}}>â€¢ <strong style={{color: '#eab308'}}>40~59ì </strong>: ë¶„í•  ë§¤ìˆ˜ ê³ ë ¤</div><div>â€¢ <strong style={{color: '#ef4444'}}>40ì  ë¯¸ë§Œ</strong>: ê´€ë§ ê¶Œì¥</div></div></div>
              <div style={{marginBottom: '20px'}}><div style={{fontSize: '15px', fontWeight: '600', color: darkMode ? '#60a5fa' : '#2563eb', marginBottom: '12px'}}>âš™ï¸ ì„¤ì • ë°©ë²•</div><div style={{fontSize: '13px', color: darkMode ? '#e2e8f0' : '#374151', lineHeight: '1.8'}}><div style={{marginBottom: '6px'}}>â€¢ [ì„¤ì •í•˜ê¸°] ë²„íŠ¼ìœ¼ë¡œ ì„¤ì • ì—´ê¸°</div><div style={{marginBottom: '6px'}}>â€¢ RSI ë§¤ìˆ˜/ë§¤ë„ ì„ê³„ê°’ ì¡°ì ˆ ê°€ëŠ¥</div><div style={{marginBottom: '6px'}}>â€¢ ì§€í‘œë³„ ON/OFFë¡œ ì›í•˜ëŠ” ì§€í‘œë§Œ ë°˜ì˜</div><div>â€¢ ë³€ê²½ í›„ <strong>[ì €ì¥í•˜ê¸°]</strong> í•„ìˆ˜!</div></div></div>
              <div style={{backgroundColor: darkMode ? '#7c2d12' : '#fef3c7', padding: '14px', borderRadius: '8px', border: `1px solid ${darkMode ? '#9a3412' : '#fcd34d'}`}}><div style={{fontSize: '15px', fontWeight: '600', color: darkMode ? '#fed7aa' : '#92400e', marginBottom: '10px'}}>âš ï¸ ì£¼ì˜ì‚¬í•­</div><div style={{fontSize: '12px', color: darkMode ? '#fed7aa' : '#92400e', lineHeight: '1.7'}}>ë³¸ ì•±ì€ <strong>íˆ¬ì ì°¸ê³ ìš©</strong>ì´ë©°, ì‹¤ì œ íˆ¬ì íŒë‹¨ì€ ë³¸ì¸ ì±…ì„ì…ë‹ˆë‹¤. ê³¼ê±° ë°ì´í„° ê¸°ë°˜ ë¶„ì„ì€ ë¯¸ë˜ ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div></div>
            </div>
          )}
          <div style={{textAlign: 'center', padding: '16px 0', color: darkMode ? '#64748b' : '#9ca3af', fontSize: '13px'}}><div style={{fontWeight: '600', marginBottom: '6px', color: darkMode ? '#94a3b8' : '#6b7280'}}>Today_tab</div><div><a href="mailto:contact@todaytab.com" style={{color: darkMode ? '#64748b' : '#9ca3af', textDecoration: 'none'}}>contact@todaytab.com</a></div></div>
        </div>

      </div>
    </div>
  );
}

export default App;
